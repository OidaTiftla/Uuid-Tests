# SQL-Server sorting is not the way dotnet Guid is sorting

To ensure to get a way in dotnet, that produces the same sorting as the SQL-server you can use the type `System.Data.SqlTypes.SqlGuid`.
The following lines can be used to prove this:

## SQL-server

If you run the following SQL script:

```sql
DECLARE @GuidTable TABLE(guid uniqueidentifier)

INSERT INTO @GuidTable
VALUES
('00000000-0000-0000-0000-000000000001'),
('00000000-0000-0000-0000-000000000100'),
('00000000-0000-0000-0000-000000010000'),
('00000000-0000-0000-0000-000001000000'),
('00000000-0000-0000-0000-000100000000'),
('00000000-0000-0000-0000-010000000000'),
('00000000-0000-0000-0001-000000000000'),
('00000000-0000-0000-0100-000000000000'),
('00000000-0000-0001-0000-000000000000'),
('00000000-0000-0100-0000-000000000000'),
('00000000-0001-0000-0000-000000000000'),
('00000000-0100-0000-0000-000000000000'),
('00000001-0000-0000-0000-000000000000'),
('00000100-0000-0000-0000-000000000000'),
('00010000-0000-0000-0000-000000000000'),
('01000000-0000-0000-0000-000000000000')

SELECT * FROM @GuidTable ORDER BY guid
```

You will get the following sorted table as a result:

|     | guid                                 |
| --- | ------------------------------------ |
| 0   | 01000000-0000-0000-0000-000000000000 |
| 1   | 00010000-0000-0000-0000-000000000000 |
| 2   | 00000100-0000-0000-0000-000000000000 |
| 3   | 00000001-0000-0000-0000-000000000000 |
| 4   | 00000000-0100-0000-0000-000000000000 |
| 5   | 00000000-0001-0000-0000-000000000000 |
| 6   | 00000000-0000-0100-0000-000000000000 |
| 7   | 00000000-0000-0001-0000-000000000000 |
| 8   | 00000000-0000-0000-0001-000000000000 |
| 9   | 00000000-0000-0000-0100-000000000000 |
| 10  | 00000000-0000-0000-0000-000000000001 |
| 11  | 00000000-0000-0000-0000-000000000100 |
| 12  | 00000000-0000-0000-0000-000000010000 |
| 13  | 00000000-0000-0000-0000-000001000000 |
| 14  | 00000000-0000-0000-0000-000100000000 |
| 15  | 00000000-0000-0000-0000-010000000000 |

## dotnet

If you do the same with the next script in dotnet:

```c#
var guids = Enumerable.Range(0, 16).Select(i => {
    var bytes = Enumerable.Range(0, 16).Select(_ => (byte)0).ToArray();
    bytes[i] = 1;
    return new {
        guid = new Guid(bytes),
        sqlGuid = new System.Data.SqlTypes.SqlGuid(bytes),
    };
}).ToList();

var sorted = guids.OrderBy(o => o.sqlGuid).ToList();
foreach (var o in sorted) {
    Console.WriteLine(o.guid);
}
```

You will get the following sorted GUIDs (which is the same as the order from the SQL-server):

|     | guid                                 |
| --- | ------------------------------------ |
| 0   | 01000000-0000-0000-0000-000000000000 |
| 1   | 00010000-0000-0000-0000-000000000000 |
| 2   | 00000100-0000-0000-0000-000000000000 |
| 3   | 00000001-0000-0000-0000-000000000000 |
| 4   | 00000000-0100-0000-0000-000000000000 |
| 5   | 00000000-0001-0000-0000-000000000000 |
| 6   | 00000000-0000-0100-0000-000000000000 |
| 7   | 00000000-0000-0001-0000-000000000000 |
| 8   | 00000000-0000-0000-0001-000000000000 |
| 9   | 00000000-0000-0000-0100-000000000000 |
| 10  | 00000000-0000-0000-0000-000000000001 |
| 11  | 00000000-0000-0000-0000-000000000100 |
| 12  | 00000000-0000-0000-0000-000000010000 |
| 13  | 00000000-0000-0000-0000-000001000000 |
| 14  | 00000000-0000-0000-0000-000100000000 |
| 15  | 00000000-0000-0000-0000-010000000000 |

Where on the other side this script:

```c#
var guids = Enumerable.Range(0, 16).Select(i => {
    var bytes = Enumerable.Range(0, 16).Select(_ => (byte)0).ToArray();
    bytes[i] = 1;
    return new Guid(bytes);
}).ToList();

var sorted = guids.OrderBy(o => o).ToList();
foreach (var o in sorted) {
    Console.WriteLine(o);
}
```

You will get the following sorted GUIDs (which is completely different from the way the SQL-server sorts GUIDs):

|     | guid                                 |
| --- | ------------------------------------ |
| 0   | 00000000-0000-0000-0000-000000000001 |
| 1   | 00000000-0000-0000-0000-000000000100 |
| 2   | 00000000-0000-0000-0000-000000010000 |
| 3   | 00000000-0000-0000-0000-000001000000 |
| 4   | 00000000-0000-0000-0000-000100000000 |
| 5   | 00000000-0000-0000-0000-010000000000 |
| 6   | 00000000-0000-0000-0001-000000000000 |
| 7   | 00000000-0000-0000-0100-000000000000 |
| 8   | 00000000-0000-0001-0000-000000000000 |
| 9   | 00000000-0000-0100-0000-000000000000 |
| 10  | 00000000-0001-0000-0000-000000000000 |
| 11  | 00000000-0100-0000-0000-000000000000 |
| 12  | 00000001-0000-0000-0000-000000000000 |
| 13  | 00000100-0000-0000-0000-000000000000 |
| 14  | 00010000-0000-0000-0000-000000000000 |
| 15  | 01000000-0000-0000-0000-000000000000 |

## summary

- SQL GUID sorting
  - 0f = most significant byte
  - 00 = least significant byte
  - `00010203-0405-0607-0908-0f0e0d0c0b0a`
- Windows GUID sorting
  - 0f = most significant byte
  - 00 = least significant byte
  - `0f0e0d0c-0b0a-0908-0706-050403020100`

**!!!But be careful, this has nothing to do with the order in which the bytes are saved in an array (for example when you do `guid.ToByteArray()`)!!!**
